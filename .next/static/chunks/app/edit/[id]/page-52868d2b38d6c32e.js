(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[416],{1181:function(e,a,t){Promise.resolve().then(t.bind(t,8135))},8135:function(e,a,t){"use strict";t.r(a),t.d(a,{default:function(){return o}});var s=t(7437),r=t(2660),l=t(3229),i=t(7648),n=t(9376),d=t(2265),c=t(9064),x=t(9031),m=t(4569);function o(){var e,a;let t=(0,n.useParams)(),o=(0,n.useRouter)(),u=t.id,[h,y]=(0,d.useState)({type:"cp",startDate:"",endDate:"",notes:"",isHalfDay:!1,halfDayType:"morning"}),[g,p]=(0,d.useState)(0),[f,j]=(0,d.useState)(!1),[D,v]=(0,d.useState)(!0),[N,b]=(0,d.useState)(null);(0,d.useEffect)(()=>{let e=async()=>{try{let e=await m.U0.getLeave(u);if(!e){c.ZP.error("Cong\xe9 non trouv\xe9"),o.push("/history");return}b(e),y({type:e.type,startDate:(0,x.uk)(e.startDate),endDate:(0,x.uk)(e.endDate),notes:e.notes||"",isHalfDay:e.isHalfDay||!1,halfDayType:e.halfDayType||"morning"}),p(e.workingDays)}catch(e){console.error("Erreur lors du chargement du cong\xe9:",e),c.ZP.error("Erreur lors du chargement du cong\xe9"),o.push("/history")}finally{v(!1)}};u&&e()},[u,o]),(0,d.useEffect)(()=>{if(h.startDate&&h.endDate){let e=(0,x.XW)(h.startDate),a=(0,x.XW)(h.endDate);e&&a&&new Date(e)<=new Date(a)?p((0,x.d)(e,a,(0,x.hJ)(new Date(e).getFullYear()),h.isHalfDay,h.halfDayType)):p(0)}},[h.startDate,h.endDate,h.isHalfDay,h.halfDayType]);let k=async e=>{if(e.preventDefault(),!h.startDate||!h.endDate){c.ZP.error("Veuillez saisir les dates de d\xe9but et de fin");return}if(!(0,x.Y)(h.startDate)){c.ZP.error("Format de date de d\xe9but invalide. Utilisez DD/MM/YYYY (ex: 02/01/2024)");return}if(!(0,x.Y)(h.endDate)){c.ZP.error("Format de date de fin invalide. Utilisez DD/MM/YYYY (ex: 03/01/2024)");return}let a=(0,x.XW)(h.startDate),t=(0,x.XW)(h.endDate);if(new Date(a)>new Date(t)){c.ZP.error("La date de d\xe9but ne peut pas \xeatre post\xe9rieure \xe0 la date de fin");return}if(g<=0){c.ZP.error("La p\xe9riode s\xe9lectionn\xe9e doit contenir au moins un jour ouvrable");return}j(!0);try{let e={...N,type:h.type,startDate:a,endDate:t,workingDays:g,notes:h.notes.trim(),isHalfDay:h.isHalfDay,halfDayType:h.halfDayType,updatedAt:new Date().toISOString()};await m.U0.updateLeave(e),c.ZP.success("Cong\xe9 mis \xe0 jour avec succ\xe8s"),o.push("/history")}catch(e){console.error("Erreur lors de la mise \xe0 jour du cong\xe9:",e),c.ZP.error("Erreur lors de la mise \xe0 jour du cong\xe9")}finally{j(!1)}},w=[{value:"cp",label:"CP - Cong\xe9s pay\xe9s",color:"bg-blue-100 text-blue-800"},{value:"rtt",label:"RTT - R\xe9duction du temps de travail",color:"bg-green-100 text-green-800"},{value:"cet",label:"CET - Compte \xe9pargne temps",color:"bg-purple-100 text-purple-800"}];return D?(0,s.jsx)("div",{className:"min-h-screen bg-gray-50 dark:bg-gray-900 flex items-center justify-center",children:(0,s.jsx)("div",{className:"loading-spinner h-12 w-12"})}):(0,s.jsxs)("div",{className:"min-h-screen bg-gray-50 dark:bg-gray-900",children:[(0,s.jsx)("header",{className:"bg-white dark:bg-gray-800 shadow-sm border-b border-gray-200 dark:border-gray-700",children:(0,s.jsx)("div",{className:"max-w-4xl mx-auto px-4 sm:px-6 lg:px-8",children:(0,s.jsx)("div",{className:"flex justify-between items-center py-6",children:(0,s.jsxs)("div",{className:"flex items-center space-x-4",children:[(0,s.jsxs)(i.default,{href:"/history",className:"btn-secondary",children:[(0,s.jsx)(r.Z,{className:"w-4 h-4 mr-2"}),"Retour"]}),(0,s.jsxs)("div",{children:[(0,s.jsx)("h1",{className:"text-3xl font-bold text-gray-900 dark:text-white",children:"✏️ Modifier un cong\xe9"}),(0,s.jsx)("p",{className:"text-gray-600 dark:text-gray-400",children:"Modifiez les informations de ce cong\xe9"})]})]})})})}),(0,s.jsx)("main",{className:"max-w-4xl mx-auto px-4 sm:px-6 lg:px-8 py-8",children:(0,s.jsxs)("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-8",children:[(0,s.jsx)("div",{className:"lg:col-span-2",children:(0,s.jsxs)("div",{className:"card",children:[(0,s.jsx)("div",{className:"card-header",children:(0,s.jsx)("h2",{className:"text-xl font-semibold text-gray-900 dark:text-white",children:"\uD83D\uDCDD Informations du cong\xe9"})}),(0,s.jsx)("div",{className:"card-body",children:(0,s.jsxs)("form",{onSubmit:k,className:"space-y-6",children:[(0,s.jsxs)("div",{children:[(0,s.jsx)("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:"Type de cong\xe9 *"}),(0,s.jsx)("select",{value:h.type,onChange:e=>y({...h,type:e.target.value}),className:"select",required:!0,children:w.map(e=>(0,s.jsx)("option",{value:e.value,children:e.label},e.value))})]}),(0,s.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[(0,s.jsxs)("div",{children:[(0,s.jsx)("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:"Date de d\xe9but *"}),(0,s.jsx)("input",{type:"text",value:h.startDate,onChange:e=>y({...h,startDate:e.target.value}),className:"input",required:!0,placeholder:"DD/MM/YYYY (ex: 02/01/2024)"})]}),(0,s.jsxs)("div",{children:[(0,s.jsx)("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:"Date de fin *"}),(0,s.jsx)("input",{type:"text",value:h.endDate,onChange:e=>y({...h,endDate:e.target.value}),className:"input",required:!0,placeholder:"DD/MM/YYYY (ex: 03/01/2024)"})]})]}),(0,s.jsxs)("div",{children:[(0,s.jsx)("div",{className:"flex items-center space-x-4",children:(0,s.jsxs)("label",{className:"flex items-center",children:[(0,s.jsx)("input",{type:"checkbox",checked:h.isHalfDay,onChange:e=>y({...h,isHalfDay:e.target.checked}),className:"rounded border-gray-300 text-primary-600 shadow-sm focus:border-primary-300 focus:ring focus:ring-primary-200 focus:ring-opacity-50"}),(0,s.jsx)("span",{className:"ml-2 text-sm font-medium text-gray-700 dark:text-gray-300",children:"Demi-journ\xe9e"})]})}),h.isHalfDay&&(0,s.jsxs)("div",{className:"mt-4 ml-6",children:[(0,s.jsx)("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:"Type de demi-journ\xe9e"}),(0,s.jsxs)("div",{className:"flex space-x-4",children:[(0,s.jsxs)("label",{className:"flex items-center",children:[(0,s.jsx)("input",{type:"radio",value:"morning",checked:"morning"===h.halfDayType,onChange:e=>y({...h,halfDayType:e.target.value}),className:"text-primary-600 focus:ring-primary-500"}),(0,s.jsx)("span",{className:"ml-2 text-sm text-gray-700 dark:text-gray-300",children:"Matin"})]}),(0,s.jsxs)("label",{className:"flex items-center",children:[(0,s.jsx)("input",{type:"radio",value:"afternoon",checked:"afternoon"===h.halfDayType,onChange:e=>y({...h,halfDayType:e.target.value}),className:"text-primary-600 focus:ring-primary-500"}),(0,s.jsx)("span",{className:"ml-2 text-sm text-gray-700 dark:text-gray-300",children:"Apr\xe8s-midi"})]})]})]})]}),(0,s.jsxs)("div",{children:[(0,s.jsx)("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:"Notes (optionnel)"}),(0,s.jsx)("textarea",{value:h.notes,onChange:e=>y({...h,notes:e.target.value}),rows:3,className:"input",placeholder:"Ajoutez des notes ou commentaires sur ce cong\xe9..."})]}),(0,s.jsxs)("div",{className:"flex justify-between",children:[(0,s.jsx)(i.default,{href:"/history",className:"btn-secondary",children:"Annuler"}),(0,s.jsxs)("button",{type:"submit",disabled:f||g<=0,className:"btn-primary",children:[(0,s.jsx)(l.Z,{className:"w-4 h-4 mr-2"}),f?"Mise \xe0 jour...":"Mettre \xe0 jour"]})]})]})})]})}),(0,s.jsxs)("div",{className:"lg:col-span-1",children:[(0,s.jsxs)("div",{className:"card",children:[(0,s.jsx)("div",{className:"card-header",children:(0,s.jsx)("h2",{className:"text-xl font-semibold text-gray-900 dark:text-white",children:"\uD83D\uDCCA R\xe9sum\xe9"})}),(0,s.jsxs)("div",{className:"card-body space-y-4",children:[(0,s.jsxs)("div",{children:[(0,s.jsx)("span",{className:"text-sm font-medium text-gray-600 dark:text-gray-400",children:"Type de cong\xe9"}),(0,s.jsx)("div",{className:"mt-1",children:w.find(e=>e.value===h.type)&&(0,s.jsx)("span",{className:"inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium ".concat(null===(e=w.find(e=>e.value===h.type))||void 0===e?void 0:e.color),children:null===(a=w.find(e=>e.value===h.type))||void 0===a?void 0:a.label.split(" - ")[0]})})]}),h.startDate&&h.endDate&&(0,s.jsxs)("div",{children:[(0,s.jsx)("span",{className:"text-sm font-medium text-gray-600 dark:text-gray-400",children:"P\xe9riode"}),(0,s.jsxs)("div",{className:"mt-1 text-sm text-gray-900 dark:text-white",children:[(0,x.p6)((0,x.XW)(h.startDate))," - ",(0,x.p6)((0,x.XW)(h.endDate))]})]}),(0,s.jsxs)("div",{children:[(0,s.jsx)("span",{className:"text-sm font-medium text-gray-600 dark:text-gray-400",children:"Jours ouvrables"}),(0,s.jsxs)("div",{className:"mt-1",children:[(0,s.jsx)("span",{className:"text-2xl font-bold text-gray-900 dark:text-white",children:g}),(0,s.jsxs)("span",{className:"text-sm text-gray-600 dark:text-gray-400 ml-1",children:["jour",g>1?"s":""]})]})]}),h.isHalfDay&&(0,s.jsxs)("div",{children:[(0,s.jsx)("span",{className:"text-sm font-medium text-gray-600 dark:text-gray-400",children:"Demi-journ\xe9e"}),(0,s.jsx)("div",{className:"mt-1 text-sm text-gray-900 dark:text-white",children:"morning"===h.halfDayType?"Matin":"Apr\xe8s-midi"})]}),h.startDate&&h.endDate&&(0,s.jsx)("div",{className:"mt-4 p-3 rounded-lg bg-gray-50 dark:bg-gray-700",children:g>0?(0,s.jsx)("div",{className:"text-sm text-green-600 dark:text-green-400",children:"✅ P\xe9riode valide"}):(0,s.jsx)("div",{className:"text-sm text-red-600 dark:text-red-400",children:"❌ P\xe9riode invalide"})})]})]}),N&&(0,s.jsxs)("div",{className:"card mt-6",children:[(0,s.jsx)("div",{className:"card-header",children:(0,s.jsx)("h3",{className:"text-lg font-semibold text-gray-900 dark:text-white",children:"\uD83D\uDCCB Informations originales"})}),(0,s.jsxs)("div",{className:"card-body space-y-2 text-sm",children:[(0,s.jsxs)("div",{children:[(0,s.jsx)("span",{className:"text-gray-600 dark:text-gray-400",children:"Cr\xe9\xe9 le:"}),(0,s.jsx)("span",{className:"ml-2 text-gray-900 dark:text-white",children:(0,x.p6)(N.createdAt)})]}),(0,s.jsxs)("div",{children:[(0,s.jsx)("span",{className:"text-gray-600 dark:text-gray-400",children:"Derni\xe8re modification:"}),(0,s.jsx)("span",{className:"ml-2 text-gray-900 dark:text-white",children:(0,x.p6)(N.updatedAt)})]})]})]})]})]})})]})}}},function(e){e.O(0,[216,980,744],function(){return e(e.s=1181)}),_N_E=e.O()}]);