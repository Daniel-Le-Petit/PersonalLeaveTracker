(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[938],{1673:function(e,a,t){Promise.resolve().then(t.bind(t,8301))},8301:function(e,a,t){"use strict";t.r(a),t.d(a,{default:function(){return x}});var r=t(7437),s=t(2660),i=t(2735),l=t(7689),n=t(3229),c=t(7226),o=t(5929),d=t(1047),h=t(7648),u=t(2265),y=t(9064),m=t(4569);function x(){let[e,a]=(0,u.useState)(null),[t,x]=(0,u.useState)(!0),[g,v]=(0,u.useState)(!1);(0,u.useEffect)(()=>{p()},[]);let p=async()=>{try{let e=await m.U0.getSettings();e?a(e):a({firstDayOfWeek:"monday",country:"FR",publicHolidays:[],quotas:[{type:"cp",yearlyQuota:25},{type:"rtt",yearlyQuota:10},{type:"sick",yearlyQuota:0}],darkMode:!1,notifications:!0})}catch(e){console.error("Erreur lors du chargement des param\xe8tres:",e),y.ZP.error("Erreur lors du chargement des param\xe8tres")}finally{x(!1)}},b=async()=>{if(e){v(!0);try{await m.U0.saveSettings(e),y.ZP.success("Param\xe8tres sauvegard\xe9s avec succ\xe8s")}catch(e){console.error("Erreur lors de la sauvegarde:",e),y.ZP.error("Erreur lors de la sauvegarde")}finally{v(!1)}}},w=async()=>{try{await m.U0.exportDataWithUserChoice(),y.ZP.success("Export r\xe9ussi - Choisissez o\xf9 sauvegarder le fichier")}catch(e){console.error("Erreur lors de l'export:",e),y.ZP.error("Erreur lors de l'export")}},f=async()=>{try{await m.U0.importDataWithFileSelection(),y.ZP.success("Donn\xe9es import\xe9es avec succ\xe8s");let e=await m.U0.getSettings();e&&a(e)}catch(e){console.error("Erreur lors de l'import:",e),e instanceof Error&&"Import annul\xe9"===e.message?(0,y.ZP)("Import annul\xe9"):y.ZP.error("Erreur lors de l'import")}},j=(t,r)=>{e&&a({...e,quotas:e.quotas.map(e=>e.type===t?{...e,yearlyQuota:r}:e)})};return t?(0,r.jsx)("div",{className:"min-h-screen flex items-center justify-center",children:(0,r.jsx)("div",{className:"loading-spinner h-12 w-12"})}):e?(0,r.jsxs)("div",{className:"min-h-screen bg-gray-50 dark:bg-gray-900",children:[(0,r.jsx)("header",{className:"bg-white dark:bg-gray-800 shadow-sm border-b border-gray-200 dark:border-gray-700",children:(0,r.jsx)("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8",children:(0,r.jsxs)("div",{className:"flex justify-between items-center py-6",children:[(0,r.jsxs)("div",{className:"flex items-center space-x-4",children:[(0,r.jsxs)(h.default,{href:"/",className:"btn-secondary",children:[(0,r.jsx)(s.Z,{className:"w-4 h-4 mr-2"}),"Retour"]}),(0,r.jsxs)("div",{children:[(0,r.jsx)("h1",{className:"text-3xl font-bold text-gray-900 dark:text-white",children:"⚙️ Param\xe8tres"}),(0,r.jsx)("p",{className:"text-gray-600 dark:text-gray-400",children:"Configurez vos pr\xe9f\xe9rences et quotas de cong\xe9s"})]})]}),(0,r.jsxs)("div",{className:"flex items-center space-x-4",children:[(0,r.jsxs)("button",{onClick:w,className:"btn-secondary",children:[(0,r.jsx)(i.Z,{className:"w-4 h-4 mr-2"}),"Exporter"]}),(0,r.jsxs)("button",{onClick:f,className:"btn-secondary",children:[(0,r.jsx)(l.Z,{className:"w-4 h-4 mr-2"}),"Importer"]}),(0,r.jsxs)("button",{onClick:b,disabled:g,className:"btn-primary",children:[(0,r.jsx)(n.Z,{className:"w-4 h-4 mr-2"}),g?"Sauvegarde...":"Sauvegarder"]})]})]})})}),(0,r.jsx)("main",{className:"max-w-4xl mx-auto px-4 sm:px-6 lg:px-8 py-8",children:(0,r.jsxs)("div",{className:"space-y-8",children:[(0,r.jsxs)("div",{className:"card",children:[(0,r.jsxs)("div",{className:"card-header",children:[(0,r.jsx)("h2",{className:"text-xl font-semibold text-gray-900 dark:text-white",children:"\uD83D\uDCCA Quotas de cong\xe9s annuels"}),(0,r.jsx)("p",{className:"text-sm text-gray-600 dark:text-gray-400 mt-1",children:"D\xe9finissez vos quotas pour chaque type de cong\xe9"})]}),(0,r.jsx)("div",{className:"card-body",children:(0,r.jsx)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:e.quotas.map(e=>(0,r.jsxs)("div",{className:"space-y-2",children:[(0,r.jsxs)("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300",children:[e.type.toUpperCase()," (Cong\xe9s pay\xe9s)"]}),(0,r.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,r.jsx)("input",{type:"number",min:"0",max:"365",value:e.yearlyQuota,onChange:a=>j(e.type,parseInt(a.target.value)||0),className:"input w-20"}),(0,r.jsx)("span",{className:"text-sm text-gray-600 dark:text-gray-400",children:"jours"})]})]},e.type))})})]}),(0,r.jsxs)("div",{className:"card",children:[(0,r.jsx)("div",{className:"card-header",children:(0,r.jsx)("h2",{className:"text-xl font-semibold text-gray-900 dark:text-white",children:"\uD83D\uDD27 Pr\xe9f\xe9rences g\xe9n\xe9rales"})}),(0,r.jsxs)("div",{className:"card-body space-y-6",children:[(0,r.jsxs)("div",{children:[(0,r.jsx)("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:"Premier jour de la semaine"}),(0,r.jsxs)("select",{value:e.firstDayOfWeek,onChange:t=>a({...e,firstDayOfWeek:t.target.value}),className:"select",children:[(0,r.jsx)("option",{value:"monday",children:"Lundi"}),(0,r.jsx)("option",{value:"sunday",children:"Dimanche"})]})]}),(0,r.jsxs)("div",{children:[(0,r.jsx)("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:"Pays"}),(0,r.jsxs)("select",{value:e.country,onChange:t=>a({...e,country:t.target.value}),className:"select",children:[(0,r.jsx)("option",{value:"FR",children:"France"}),(0,r.jsx)("option",{value:"BE",children:"Belgique"}),(0,r.jsx)("option",{value:"CH",children:"Suisse"}),(0,r.jsx)("option",{value:"CA",children:"Canada"}),(0,r.jsx)("option",{value:"US",children:"\xc9tats-Unis"})]})]}),(0,r.jsxs)("div",{className:"flex items-center justify-between",children:[(0,r.jsxs)("div",{children:[(0,r.jsx)("label",{className:"text-sm font-medium text-gray-700 dark:text-gray-300",children:"Mode sombre"}),(0,r.jsx)("p",{className:"text-sm text-gray-600 dark:text-gray-400",children:"Activer le th\xe8me sombre pour l'interface"})]}),(0,r.jsxs)("button",{onClick:()=>{if(!e)return;let t=!e.darkMode;a({...e,darkMode:t}),t?document.documentElement.classList.add("dark"):document.documentElement.classList.remove("dark")},className:"relative inline-flex h-6 w-11 items-center rounded-full transition-colors focus:outline-none focus:ring-2 focus:ring-primary-500 focus:ring-offset-2 ".concat(e.darkMode?"bg-primary-600":"bg-gray-200"),children:[(0,r.jsx)("span",{className:"inline-block h-4 w-4 transform rounded-full bg-white transition-transform ".concat(e.darkMode?"translate-x-6":"translate-x-1")}),e.darkMode?(0,r.jsx)(c.Z,{className:"absolute right-1 h-3 w-3 text-white"}):(0,r.jsx)(o.Z,{className:"absolute left-1 h-3 w-3 text-gray-400"})]})]}),(0,r.jsxs)("div",{className:"flex items-center justify-between",children:[(0,r.jsxs)("div",{children:[(0,r.jsx)("label",{className:"text-sm font-medium text-gray-700 dark:text-gray-300",children:"Notifications"}),(0,r.jsx)("p",{className:"text-sm text-gray-600 dark:text-gray-400",children:"Recevoir des notifications pour les rappels"})]}),(0,r.jsx)("button",{onClick:()=>{e&&a({...e,notifications:!e.notifications})},className:"relative inline-flex h-6 w-11 items-center rounded-full transition-colors focus:outline-none focus:ring-2 focus:ring-primary-500 focus:ring-offset-2 ".concat(e.notifications?"bg-primary-600":"bg-gray-200"),children:(0,r.jsx)("span",{className:"inline-block h-4 w-4 transform rounded-full bg-white transition-transform ".concat(e.notifications?"translate-x-6":"translate-x-1")})})]})]})]}),(0,r.jsxs)("div",{className:"card",children:[(0,r.jsxs)("div",{className:"card-header",children:[(0,r.jsx)("h2",{className:"text-xl font-semibold text-gray-900 dark:text-white",children:"\uD83C\uDF89 Jours f\xe9ri\xe9s"}),(0,r.jsx)("p",{className:"text-sm text-gray-600 dark:text-gray-400 mt-1",children:"Les jours f\xe9ri\xe9s sont automatiquement d\xe9tect\xe9s selon votre pays"})]}),(0,r.jsx)("div",{className:"card-body",children:(0,r.jsxs)("div",{className:"text-center py-8",children:[(0,r.jsx)(d.Z,{className:"mx-auto h-12 w-12 text-gray-400 mb-4"}),(0,r.jsxs)("p",{className:"text-gray-600 dark:text-gray-400",children:["Les jours f\xe9ri\xe9s pour ",e.country," sont automatiquement configur\xe9s"]}),(0,r.jsx)("p",{className:"text-sm text-gray-500 dark:text-gray-500 mt-2",children:"Cette fonctionnalit\xe9 sera bient\xf4t disponible"})]})})]}),(0,r.jsxs)("div",{className:"card",children:[(0,r.jsx)("div",{className:"card-header",children:(0,r.jsx)("h2",{className:"text-xl font-semibold text-gray-900 dark:text-white",children:"\uD83D\uDD27 Maintenance"})}),(0,r.jsx)("div",{className:"card-body",children:(0,r.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[(0,r.jsx)("button",{onClick:()=>{confirm("\xcates-vous s\xfbr de vouloir r\xe9initialiser toutes les donn\xe9es ? Cette action est irr\xe9versible.")&&(m.U0.clearAllData(),y.ZP.success("Donn\xe9es r\xe9initialis\xe9es"),p())},className:"btn-danger w-full",children:"R\xe9initialiser toutes les donn\xe9es"}),(0,r.jsx)("button",{onClick:()=>{confirm("\xcates-vous s\xfbr de vouloir supprimer tous les cong\xe9s ?")&&(m.U0.clearLeaves(),y.ZP.success("Cong\xe9s supprim\xe9s"))},className:"btn-warning w-full",children:"Supprimer tous les cong\xe9s"})]})})]})]})})]}):(0,r.jsx)("div",{className:"min-h-screen flex items-center justify-center",children:(0,r.jsx)("div",{className:"text-center",children:(0,r.jsx)("p",{className:"text-gray-600 dark:text-gray-400",children:"Erreur lors du chargement des param\xe8tres"})})})}},4569:function(e,a,t){"use strict";t.d(a,{U0:function(){return i}});var r=t(960);class s{async init(){this.db||(this.db=await (0,r.X3)(this.DB_NAME,this.DB_VERSION,{upgrade(e){let a=e.createObjectStore("leaves",{keyPath:"id"});a.createIndex("by-date","startDate"),a.createIndex("by-type","type"),e.createObjectStore("settings",{keyPath:"id"}),e.createObjectStore("balances",{keyPath:"id"}),e.createObjectStore("holidays",{keyPath:"id"});let t=e.createObjectStore("carryover",{keyPath:"id"});t.createIndex("by-type","type"),t.createIndex("by-year","year")}}))}async getLeaves(){return await this.init(),this.db.getAll("leaves")}async getLeave(e){return await this.init(),this.db.get("leaves",e)}async addLeave(e){await this.init(),await this.db.add("leaves",e)}async updateLeave(e){await this.init(),await this.db.put("leaves",e)}async deleteLeave(e){await this.init(),await this.db.delete("leaves",e)}async saveLeaves(e){for(let a of(await this.init(),await this.db.clear("leaves"),e))await this.db.add("leaves",a)}async clearLeaves(){await this.init(),await this.db.clear("leaves")}async getLeavesByYear(e){return await this.init(),(await this.getLeaves()).filter(a=>new Date(a.startDate).getFullYear()===e)}async getLeavesByType(e){return await this.init(),this.db.getAllFromIndex("leaves","by-type",e)}async getSettings(){return await this.init(),this.db.get("settings","app-settings")}async saveSettings(e){await this.init(),await this.db.put("settings",{id:"app-settings",...e})}async getBalances(){return await this.init(),await this.db.get("balances","current-balances")||[]}async saveBalances(e){await this.init(),await this.db.put("balances",{id:"current-balances",balances:e})}async getHolidays(){return await this.init(),await this.db.get("holidays","french-holidays")||[]}async saveHolidays(e){await this.init(),await this.db.put("holidays",{id:"french-holidays",holidays:e})}async getCarryoverLeaves(){try{return await this.init(),this.db.getAll("carryover")}catch(e){return console.log("Store carryover non trouv\xe9, retour d'un tableau vide:",e),[]}}async getCarryoverLeave(e){return await this.init(),this.db.get("carryover",e)}async addCarryoverLeave(e){await this.init(),await this.db.add("carryover",e)}async updateCarryoverLeave(e){await this.init(),await this.db.put("carryover",e)}async deleteCarryoverLeave(e){await this.init(),await this.db.delete("carryover",e)}async saveCarryoverLeaves(e){for(let a of(await this.init(),await this.db.clear("carryover"),e))await this.db.add("carryover",a)}async clearCarryoverLeaves(){await this.init(),await this.db.clear("carryover")}async getCarryoverLeavesByType(e){return await this.init(),this.db.getAllFromIndex("carryover","by-type",e)}async getCarryoverLeavesByYear(e){return await this.init(),this.db.getAllFromIndex("carryover","by-year",e)}async exportData(){let e=await this.getLeaves(),a=await this.getSettings(),t=await this.getBalances(),r=await this.getHolidays(),s=[];try{s=await this.getCarryoverLeaves()}catch(e){console.log("Carryover store non trouv\xe9 lors de l'export:",e),s=[]}return JSON.stringify({leaves:e,settings:a,balances:t,holidays:r,carryovers:s,exportDate:new Date().toISOString(),version:"1.0.0"},null,2)}async exportDataWithUserChoice(){try{let e=await this.exportData(),a="leave-tracker-backup-".concat(new Date().toISOString().split("T")[0],".json");if(navigator.share&&navigator.canShare){let t=new Blob([e],{type:"application/json"}),r=new File([t],a,{type:"application/json"});if(navigator.canShare({files:[r]})){await navigator.share({files:[r],title:"Leave Tracker Backup",text:"Sauvegarde Leave Tracker du ".concat(new Date().toLocaleDateString("fr-FR"))});return}}this.downloadFile(e,a)}catch(t){console.error("Erreur lors de l'export:",t);let e=await this.exportData(),a="leave-tracker-backup-".concat(new Date().toISOString().split("T")[0],".json");this.downloadFile(e,a)}}downloadFile(e,a){let t=new Blob([e],{type:"application/json"}),r=URL.createObjectURL(t),s=document.createElement("a");s.href=r,s.download=a,document.body.appendChild(s),s.click(),document.body.removeChild(s),URL.revokeObjectURL(r)}async importData(e){try{let a=JSON.parse(e);if(!a.leaves||!Array.isArray(a.leaves))throw Error("Format de donn\xe9es invalide");for(let e of(await this.init(),await this.db.clear("leaves"),await this.db.clear("settings"),await this.db.clear("balances"),await this.db.clear("holidays"),await this.db.clear("carryover"),a.leaves))await this.addLeave(e);a.settings&&await this.saveSettings(a.settings),a.balances&&await this.saveBalances(a.balances),a.holidays&&await this.saveHolidays(a.holidays),a.carryovers&&await this.saveCarryoverLeaves(a.carryovers)}catch(e){throw console.error("Erreur lors de l'import:",e),Error("Erreur lors de l'import des donn\xe9es")}}async importDataWithFileSelection(){return new Promise((e,a)=>{let t=document.createElement("input");t.type="file",t.accept=".json",t.style.display="none",t.onchange=async r=>{var s;let i=null===(s=r.target.files)||void 0===s?void 0:s[0];if(!i){a(Error("Aucun fichier s\xe9lectionn\xe9"));return}try{let a=await i.text();await this.importData(a),e()}catch(e){a(e)}finally{document.body.removeChild(t)}},t.oncancel=()=>{a(Error("Import annul\xe9")),document.body.removeChild(t)},document.body.appendChild(t),t.click()})}async backupToLocalStorage(){try{let e=await this.exportData();localStorage.setItem("leave-tracker-backup",e),localStorage.setItem("leave-tracker-backup-date",new Date().toISOString());let a=new Date().toISOString().split("T")[0];localStorage.setItem("leave-tracker-backup-".concat(a),e),this.cleanupOldBackups()}catch(e){console.error("Erreur lors de la sauvegarde:",e)}}async restoreFromLocalStorage(){try{let e=localStorage.getItem("leave-tracker-backup");if(e)return await this.importData(e),!0;let a=Object.keys(localStorage).filter(e=>e.startsWith("leave-tracker-backup-")).sort().reverse();if(a.length>0){let e=localStorage.getItem(a[0]);if(e)return await this.importData(e),!0}return!1}catch(e){return console.error("Erreur lors de la restauration:",e),!1}}cleanupOldBackups(){try{let e=Object.keys(localStorage).filter(e=>e.startsWith("leave-tracker-backup-")).sort().reverse();e.length>5&&e.slice(5).forEach(e=>{localStorage.removeItem(e)})}catch(e){console.error("Erreur lors du nettoyage des sauvegardes:",e)}}async getAvailableBackups(){try{let e=[],a=localStorage.getItem("leave-tracker-backup");if(a){let t=localStorage.getItem("leave-tracker-backup-date");e.push({date:t||"Unknown",size:a.length})}return Object.keys(localStorage).filter(e=>e.startsWith("leave-tracker-backup-")).sort().reverse().forEach(a=>{let t=localStorage.getItem(a);if(t){let r=a.replace("leave-tracker-backup-","");e.push({date:r,size:t.length})}}),e}catch(e){return console.error("Erreur lors de la r\xe9cup\xe9ration des sauvegardes:",e),[]}}async clearAllData(){await this.init(),await this.db.clear("leaves"),await this.db.clear("settings"),await this.db.clear("balances"),await this.db.clear("holidays"),await this.db.clear("carryover")}async getDatabaseStats(){await this.init();let e=await this.getLeaves(),a=localStorage.getItem("leave-tracker-backup-date");return{totalLeaves:e.length,totalSize:new Blob([JSON.stringify(e)]).size,lastBackup:a||void 0}}constructor(){this.db=null,this.DB_NAME="LeaveTrackerDB",this.DB_VERSION=1}}let i=new s}},function(e){e.O(0,[216,744],function(){return e(e.s=1673)}),_N_E=e.O()}]);