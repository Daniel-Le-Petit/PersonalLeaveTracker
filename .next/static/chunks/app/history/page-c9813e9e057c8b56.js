(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[811],{7649:function(e,t,a){Promise.resolve().then(a.bind(a,8090))},8090:function(e,t,a){"use strict";a.r(t),a.d(t,{default:function(){return y}});var s=a(7437),r=a(2660),l=a(3247),d=a(740),c=a(4630),n=a(8930),i=a(1047),x=a(7648),o=a(2265),m=a(9064),g=a(9031),h=a(4569),u=a(9376);function y(){let[e,t]=(0,o.useState)([]),[a,y]=(0,o.useState)([]),[p,j]=(0,o.useState)(!0),[b,v]=(0,o.useState)(""),[N,k]=(0,o.useState)("all"),[f,w]=(0,o.useState)(new Date().getFullYear().toString()),[D,C]=(0,o.useState)("all"),S=(0,u.useRouter)();(0,o.useEffect)(()=>{E()},[]),(0,o.useEffect)(()=>{T()},[e,b,N,f,D]);let E=async()=>{try{let e=await h.U0.getLeaves();t(e)}catch(e){console.error("Erreur lors du chargement des cong\xe9s:",e),m.ZP.error("Erreur lors du chargement des cong\xe9s")}finally{j(!1)}},T=()=>{let t=e;"all"!==f&&(t=t.filter(e=>new Date(e.startDate).getFullYear().toString()===f)),"all"!==N&&(t=t.filter(e=>e.type===N)),"all"!==D&&("real"===D?t=t.filter(e=>!e.isForecast):"forecast"===D&&(t=t.filter(e=>e.isForecast))),b&&(t=t.filter(e=>{var t;return(null===(t=e.notes)||void 0===t?void 0:t.toLowerCase().includes(b.toLowerCase()))||e.type.toLowerCase().includes(b.toLowerCase())||(0,g.p6)(e.startDate).includes(b)||(0,g.p6)(e.endDate).includes(b)})),t.sort((e,t)=>new Date(t.startDate).getTime()-new Date(e.startDate).getTime()),y(t)},Z=async a=>{if(confirm("\xcates-vous s\xfbr de vouloir supprimer ce cong\xe9 ?"))try{let s=e.filter(e=>e.id!==a);await h.U0.saveLeaves(s),t(s),m.ZP.success("Cong\xe9 supprim\xe9 avec succ\xe8s")}catch(e){console.error("Erreur lors de la suppression:",e),m.ZP.error("Erreur lors de la suppression")}},F=e=>({cp:"CP - Cong\xe9s pay\xe9s",rtt:"RTT - R\xe9duction du temps de travail",sick:"Maladie"})[e]||e,R=e=>({cp:"bg-blue-100 text-blue-800 dark:bg-blue-900 dark:text-blue-200",rtt:"bg-green-100 text-green-800 dark:bg-green-900 dark:text-green-200",sick:"bg-orange-100 text-orange-800 dark:bg-orange-900 dark:text-orange-200"})[e]||"bg-gray-100 text-gray-800 dark:bg-gray-900 dark:text-gray-200";return p?(0,s.jsx)("div",{className:"min-h-screen flex items-center justify-center",children:(0,s.jsx)("div",{className:"loading-spinner h-12 w-12"})}):(0,s.jsxs)("div",{className:"min-h-screen bg-gray-50 dark:bg-gray-900",children:[(0,s.jsx)("header",{className:"bg-white dark:bg-gray-800 shadow-sm border-b border-gray-200 dark:border-gray-700",children:(0,s.jsx)("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8",children:(0,s.jsxs)("div",{className:"flex justify-between items-center py-6",children:[(0,s.jsxs)("div",{className:"flex items-center space-x-4",children:[(0,s.jsxs)(x.default,{href:"/",className:"btn-secondary",children:[(0,s.jsx)(r.Z,{className:"w-4 h-4 mr-2"}),"Retour"]}),(0,s.jsxs)("div",{children:[(0,s.jsx)("h1",{className:"text-3xl font-bold text-gray-900 dark:text-white",children:"\uD83D\uDCC5 Historique des cong\xe9s"}),(0,s.jsx)("p",{className:"text-gray-600 dark:text-gray-400",children:"Consultez et g\xe9rez tous vos cong\xe9s"})]})]}),(0,s.jsx)("div",{className:"flex items-center space-x-4",children:(0,s.jsxs)("span",{className:"text-sm text-gray-600 dark:text-gray-400",children:[a.length," cong\xe9",a.length>1?"s":""]})})]})})}),(0,s.jsx)("div",{className:"bg-white dark:bg-gray-800 border-b border-gray-200 dark:border-gray-700",children:(0,s.jsx)("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-4",children:(0,s.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-5 gap-4",children:[(0,s.jsxs)("div",{className:"relative",children:[(0,s.jsx)(l.Z,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 h-4 w-4 text-gray-400"}),(0,s.jsx)("input",{type:"text",placeholder:"Rechercher...",value:b,onChange:e=>v(e.target.value),className:"input pl-10"})]}),(0,s.jsx)("div",{children:(0,s.jsxs)("select",{value:f,onChange:e=>w(e.target.value),className:"select",title:"S\xe9lectionner une ann\xe9e",children:[(0,s.jsx)("option",{value:"all",children:"Toutes les ann\xe9es"}),Array.from(new Set(e.map(e=>new Date(e.startDate).getFullYear()))).sort((e,t)=>t-e).map(e=>(0,s.jsx)("option",{value:e.toString(),children:e},e))]})}),(0,s.jsx)("div",{children:(0,s.jsxs)("select",{value:N,onChange:e=>k(e.target.value),className:"select",title:"S\xe9lectionner un type de cong\xe9",children:[(0,s.jsx)("option",{value:"all",children:"Tous les types"}),Array.from(new Set(e.map(e=>e.type))).map(e=>(0,s.jsx)("option",{value:e,children:F(e)},e))]})}),(0,s.jsx)("div",{children:(0,s.jsxs)("select",{value:D,onChange:e=>C(e.target.value),className:"select",title:"S\xe9lectionner un mode (R\xe9el/Pr\xe9visions)",children:[(0,s.jsx)("option",{value:"all",children:"Tous les modes"}),(0,s.jsx)("option",{value:"real",children:"R\xe9el"}),(0,s.jsx)("option",{value:"forecast",children:"Pr\xe9visions"})]})}),(0,s.jsx)("div",{children:(0,s.jsxs)("button",{onClick:()=>{v(""),k("all"),w(new Date().getFullYear().toString()),C("all")},className:"btn-secondary w-full",children:[(0,s.jsx)(d.Z,{className:"w-4 h-4 mr-2"}),"R\xe9initialiser"]})})]})})}),(0,s.jsxs)("main",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8",children:[a.length>0?(0,s.jsx)("div",{className:"card",children:(0,s.jsx)("div",{className:"overflow-x-auto",children:(0,s.jsxs)("table",{className:"table",children:[(0,s.jsx)("thead",{className:"table-header",children:(0,s.jsxs)("tr",{className:"bg-gray-100 dark:bg-gray-800",children:[(0,s.jsx)("th",{className:"px-4 py-2 text-left text-sm font-semibold text-gray-900 dark:text-white border-r border-gray-200 dark:border-gray-700",children:"Date"}),(0,s.jsx)("th",{className:"px-4 py-2 text-left text-sm font-semibold text-gray-900 dark:text-white border-r border-gray-200 dark:border-gray-700",children:"Type"}),(0,s.jsx)("th",{className:"px-4 py-2 text-center text-sm font-semibold text-gray-900 dark:text-white border-r border-gray-200 dark:border-gray-700",children:"Jours"}),(0,s.jsx)("th",{className:"px-4 py-2 text-center text-sm font-semibold text-gray-900 dark:text-white border-r border-gray-200 dark:border-gray-700",children:"Mode"}),(0,s.jsx)("th",{className:"px-4 py-2 text-center text-sm font-semibold text-gray-900 dark:text-white border-r border-gray-200 dark:border-gray-700",children:"Actions"})]})}),(0,s.jsx)("tbody",{className:"table-body",children:a.map(e=>(0,s.jsxs)("tr",{className:"hover:bg-gray-50 dark:hover:bg-gray-700",children:[(0,s.jsx)("td",{className:"table-cell",children:(0,s.jsxs)("div",{className:"text-sm",children:[(0,s.jsxs)("div",{className:"font-medium text-gray-900 dark:text-white",children:[(0,g.p6)(e.startDate)," - ",(0,g.p6)(e.endDate)]}),(0,s.jsx)("div",{className:"text-gray-500 dark:text-gray-400",children:new Date(e.startDate).getFullYear()})]})}),(0,s.jsxs)("td",{className:"table-cell",children:[(0,s.jsx)("span",{className:"badge ".concat(R(e.type)),children:e.type.toUpperCase()}),e.isHalfDay&&(0,s.jsxs)("span",{className:"ml-2 text-xs text-gray-500 dark:text-gray-400",children:["(","morning"===e.halfDayType?"Matin":"Apr\xe8s-midi",")"]})]}),(0,s.jsxs)("td",{className:"table-cell",children:[(0,s.jsx)("span",{className:"font-semibold text-gray-900 dark:text-white",children:e.workingDays}),(0,s.jsxs)("span",{className:"text-gray-500 dark:text-gray-400 ml-1",children:["jour",e.workingDays>1?"s":""]})]}),(0,s.jsx)("td",{className:"table-cell",children:(0,s.jsx)("span",{className:"badge ".concat(e.isForecast?"bg-purple-100 text-purple-800 dark:bg-purple-900 dark:text-purple-200":"bg-green-100 text-green-800 dark:bg-green-900 dark:text-green-200"),children:e.isForecast?"Pr\xe9vision":"R\xe9el"})}),(0,s.jsx)("td",{className:"table-cell",children:(0,s.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,s.jsx)("button",{onClick:()=>{S.push("/edit/".concat(e.id))},className:"text-primary-600 hover:text-primary-800 dark:text-primary-400 dark:hover:text-primary-200",title:"Modifier",children:(0,s.jsx)(c.Z,{className:"w-4 h-4"})}),(0,s.jsx)("button",{onClick:()=>Z(e.id),className:"text-red-600 hover:text-red-800 dark:text-red-400 dark:hover:text-red-200",title:"Supprimer",children:(0,s.jsx)(n.Z,{className:"w-4 h-4"})})]})})]},e.id))})]})})}):(0,s.jsx)("div",{className:"card",children:(0,s.jsx)("div",{className:"card-body",children:(0,s.jsxs)("div",{className:"text-center py-12",children:[(0,s.jsx)(i.Z,{className:"mx-auto h-12 w-12 text-gray-400 mb-4"}),(0,s.jsx)("h3",{className:"text-lg font-medium text-gray-900 dark:text-white mb-2",children:0===e.length?"Aucun cong\xe9 enregistr\xe9":"Aucun cong\xe9 trouv\xe9"}),(0,s.jsx)("p",{className:"text-gray-600 dark:text-gray-400 mb-4",children:0===e.length?"Commencez par ajouter votre premier cong\xe9":"Essayez de modifier vos crit\xe8res de recherche"}),0===e.length&&(0,s.jsxs)(x.default,{href:"/add",className:"btn-primary",children:[(0,s.jsx)(i.Z,{className:"w-4 h-4 mr-2"}),"Ajouter un cong\xe9"]})]})})}),a.length>0&&(0,s.jsx)("div",{className:"mt-8",children:(0,s.jsxs)("div",{className:"card",children:[(0,s.jsx)("div",{className:"card-header",children:(0,s.jsx)("h2",{className:"text-xl font-semibold text-gray-900 dark:text-white",children:"\uD83D\uDCCA Statistiques"})}),(0,s.jsx)("div",{className:"card-body",children:(0,s.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-6",children:[(0,s.jsxs)("div",{className:"text-center",children:[(0,s.jsx)("div",{className:"text-2xl font-bold text-gray-900 dark:text-white",children:a.length}),(0,s.jsxs)("div",{className:"text-sm text-gray-600 dark:text-gray-400",children:["Cong\xe9",a.length>1?"s":""]})]}),(0,s.jsxs)("div",{className:"text-center",children:[(0,s.jsx)("div",{className:"text-2xl font-bold text-gray-900 dark:text-white",children:a.reduce((e,t)=>e+t.workingDays,0)}),(0,s.jsx)("div",{className:"text-sm text-gray-600 dark:text-gray-400",children:"Jours totaux"})]}),(0,s.jsxs)("div",{className:"text-center",children:[(0,s.jsx)("div",{className:"text-2xl font-bold text-gray-900 dark:text-white",children:Math.round(a.reduce((e,t)=>e+t.workingDays,0)/a.length*10)/10}),(0,s.jsx)("div",{className:"text-sm text-gray-600 dark:text-gray-400",children:"Jours moyens"})]}),(0,s.jsxs)("div",{className:"text-center",children:[(0,s.jsx)("div",{className:"text-2xl font-bold text-gray-900 dark:text-white",children:new Set(a.map(e=>e.type)).size}),(0,s.jsx)("div",{className:"text-sm text-gray-600 dark:text-gray-400",children:"Types utilis\xe9s"})]})]})})]})})]})]})}}},function(e){e.O(0,[216,980,744],function(){return e(e.s=7649)}),_N_E=e.O()}]);