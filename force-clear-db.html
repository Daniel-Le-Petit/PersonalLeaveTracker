<!DOCTYPE html>
<html>
<head>
    <title>Force Clear IndexedDB</title>
    <style>
        body { font-family: Arial, sans-serif; padding: 20px; }
        button { padding: 10px 20px; margin: 10px; background: #dc2626; color: white; border: none; border-radius: 5px; cursor: pointer; }
        button:hover { background: #b91c1c; }
        .success { color: green; font-weight: bold; }
        .error { color: red; font-weight: bold; }
    </style>
</head>
<body>
    <h1>üîß Force Clear IndexedDB</h1>
    <p>Ce script va supprimer compl√®tement la base de donn√©es IndexedDB du Leave Tracker.</p>
    
    <button onclick="clearAllDatabases()">üóëÔ∏è Supprimer TOUTES les bases de donn√©es</button>
    <button onclick="clearSpecificDB()">üóëÔ∏è Supprimer LeaveTrackerDB uniquement</button>
    
    <div id="result"></div>

    <script>
        function clearAllDatabases() {
            const resultDiv = document.getElementById('result');
            resultDiv.innerHTML = '<p>Suppression de toutes les bases de donn√©es...</p>';
            
            // Lister toutes les bases de donn√©es
            const request = indexedDB.databases();
            
            request.onsuccess = function() {
                const databases = request.result;
                let deletedCount = 0;
                
                databases.forEach(db => {
                    const deleteRequest = indexedDB.deleteDatabase(db.name);
                    deleteRequest.onsuccess = function() {
                        deletedCount++;
                        resultDiv.innerHTML = `<p class="success">‚úÖ Base de donn√©es "${db.name}" supprim√©e</p>`;
                        
                        if (deletedCount === databases.length) {
                            resultDiv.innerHTML += `<p class="success">üéâ ${deletedCount} base(s) de donn√©es supprim√©e(s) avec succ√®s !</p>
                                                   <p>Vous pouvez maintenant retourner √† l'application.</p>`;
                        }
                    };
                    deleteRequest.onerror = function() {
                        resultDiv.innerHTML += `<p class="error">‚ùå Erreur lors de la suppression de "${db.name}"</p>`;
                    };
                });
            };
            
            request.onerror = function() {
                resultDiv.innerHTML = '<p class="error">‚ùå Erreur lors de la r√©cup√©ration de la liste des bases de donn√©es</p>';
            };
        }
        
        function clearSpecificDB() {
            const resultDiv = document.getElementById('result');
            resultDiv.innerHTML = '<p>Suppression de LeaveTrackerDB...</p>';
            
            const request = indexedDB.deleteDatabase('LeaveTrackerDB');
            
            request.onsuccess = function() {
                resultDiv.innerHTML = '<p class="success">‚úÖ LeaveTrackerDB supprim√©e avec succ√®s !</p><p>Vous pouvez maintenant retourner √† l\'application.</p>';
            };
            
            request.onerror = function() {
                resultDiv.innerHTML = '<p class="error">‚ùå Erreur lors de la suppression de LeaveTrackerDB</p>';
            };
        }
    </script>
</body>
</html>
